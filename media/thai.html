<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏™‡∏∑‡πà‡∏≠‡∏ù‡∏∂‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (‡∏õ‡∏£‡∏∞‡∏ñ‡∏°) ‚Äî ‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å‡∏õ‡∏£‡∏∞‡∏ñ‡∏°</h1>
    </header>
    <nav>
        <a href="index.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
        <a href="thai.html">‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</a>
        <a href="english.html">‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</a>
        <a href="math.html">‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</a>
    </nav>

  <style>
    :root{
      --bg:#f7fbff;
      --primary:#ffaf45;
      --accent:#63b3ed;
      --good:#00c853;
      --warn:#ff7043;
      --ink:#1f2937;
      --card:#ffffff;
    }
    *{box-sizing:border-box}
    body{font-family:"Noto Sans Thai", system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:var(--bg); color:var(--ink); margin:0}
    header{background:linear-gradient(90deg,#ffd36e,var(--primary)); padding:18px; text-align:center; font-weight:700; font-size:22px}
    main{max-width:1100px; margin:18px auto 88px; padding:0 14px}
    .grid{display:grid; grid-template-columns:1fr; gap:16px}
    @media(min-width:1000px){ .grid{grid-template-columns:1fr 1fr} }
    .card{background:var(--card); border-radius:16px; box-shadow:0 8px 24px rgba(0,0,0,.06); padding:16px}
    h2{margin:6px 0 12px 0; font-size:20px}
    .badge{display:inline-block; padding:4px 10px; border-radius:999px; background:#fff3; color:#222; margin-left:8px; font-size:12px}
    button{border:0; border-radius:10px; padding:10px 14px; cursor:pointer; font-size:16px}
    .btn{background:#fff; border:2px solid #eee}
    .btn.primary{background:var(--accent); color:#fff; border:0}
    .btn.success{background:var(--good); color:#fff}
    .btn.warn{background:var(--warn); color:#fff}
    .wrap{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .pill{padding:8px 12px; border-radius:999px; background:#f1f5f9; border:1px solid #e2e8f0; cursor:pointer}
    .pill.active{background:#e0f2fe; border-color:#90cdf4}
    .big{font-size:28px; font-weight:700}
    .cards{display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:10px}
    .tile{background:#fff7ed; border:2px solid #ffd7ae; border-radius:14px; padding:16px; text-align:center; cursor:pointer; transition:.2s}
    .tile:hover{transform:translateY(-2px)}
    .tile .ch{font-size:40px; font-weight:900}
    .tile small{display:block; color:#6b7280}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .input{padding:10px 12px; border-radius:10px; border:2px solid #e5e7eb; font-size:18px; min-width:220px}
    .mono{font-family:ui-monospace,Menlo,Consolas,monospace}
    .result{padding:10px 12px; border-radius:10px; background:#f1f5f9; border:1px dashed #cbd5e1}
    .word{display:inline-flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; background:#e0f2fe; margin:6px; font-weight:700; font-size:20px; cursor:pointer}
    .syl{display:inline-block; padding:6px 8px; border-radius:8px; background:#fff; border:1px solid #bae6fd; margin:2px; min-width:28px; text-align:center}
    .bar{height:8px; background:#e2e8f0; border-radius:999px; overflow:hidden}
    .bar > i{display:block; height:100%; width:0; background:linear-gradient(90deg,#93c5fd,#60a5fa)}
    .mt8{margin-top:8px}
    .mt12{margin-top:12px}
    .mt16{margin-top:16px}
    footer{position:fixed; left:0; right:0; bottom:0; background:#eef2ff; padding:10px 16px; text-align:center; font-size:13px; color:#334155}
  </style>
</head>
<body>
  <header>‡∏™‡∏∑‡πà‡∏≠‡∏ù‡∏∂‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‚Äî ‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏ñ‡∏° (‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î: ‡∏Å-‡∏Æ, ‡∏ú‡∏™‡∏°‡∏™‡∏£‡∏∞, ‡∏Ñ‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô, ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ, ‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏£‡∏π)</header>
  <main>
    <div class="grid">
      <!-- A. ‡∏ö‡∏±‡∏ï‡∏£‡∏Ñ‡∏≥‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞‡πÑ‡∏ó‡∏¢ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á -->
      <section class="card">
        <h2>‡∏Å ‡πÑ‡∏Å‡πà ‡∏ñ‡∏∂‡∏á ‡∏Æ ‡∏ô‡∏Å‡∏Æ‡∏π‡∏Å <span class="badge">‡∏ù‡∏∂‡∏Å‡∏ü‡∏±‡∏á-‡∏≠‡πà‡∏≤‡∏ô‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞</span></h2>
        <div class="wrap mt8">
          <button class="btn" onclick="prevSet()">‚¨ÖÔ∏è ‡∏ä‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
          <div id="setName" class="pill active">‡∏Å-‡∏á</div>
          <button class="btn" onclick="nextSet()">‡∏ä‡∏∏‡∏î‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°Ô∏è</button>
          <button class="btn primary" onclick="speakSet()">üîä ‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏∏‡∏î</button>
        </div>
        <div id="consonantGrid" class="cards mt12"></div>
      </section>

      <!-- B. ‡∏ú‡∏™‡∏°‡∏™‡∏£‡∏∞ + ‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞ ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå -->
      <section class="card">
        <h2>‡∏ú‡∏™‡∏°‡∏™‡∏£‡∏∞‡∏Å‡∏±‡∏ö‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞ <span class="badge">‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå</span></h2>
        <div class="row mt8">
          <label>‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞:</label>
          <select id="cons" class="input">
            <option>‡∏Å</option><option>‡∏Ç</option><option>‡∏Ñ</option><option>‡∏á</option><option>‡∏à</option><option>‡∏ä</option><option>‡∏ï</option><option>‡∏ô</option><option>‡∏ö</option><option>‡∏õ</option><option>‡∏°</option><option>‡∏£</option><option>‡∏•</option><option>‡∏™</option><option>‡∏´</option>
          </select>
          <label>‡∏™‡∏£‡∏∞:</label>
          <select id="vowel" class="input">
            <option value="‚óå‡∏∞">‡∏∞ (‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏±‡πâ‡∏ô)</option>
            <option value="‚óå‡∏≤">‡∏≤</option>
            <option value="‚óå‡∏¥">‡∏¥</option>
            <option value="‚óå‡∏µ">‡∏µ</option>
            <option value="‚óå‡∏∏">‡∏∏</option>
            <option value="‚óå‡∏π">‡∏π</option>
            <option value="‡πÄ‚óå‡∏∞">‡πÄ‚óå‡∏∞</option>
            <option value="‡πÄ‚óå">‡πÄ‚óå</option>
            <option value="‡πÅ‚óå‡∏∞">‡πÅ‚óå‡∏∞</option>
            <option value="‡πÅ‚óå">‡πÅ‚óå</option>
            <option value="‡πÇ‚óå‡∏∞">‡πÇ‚óå‡∏∞</option>
            <option value="‡πÇ‚óå">‡πÇ‚óå</option>
            <option value="‡πÄ‚óå‡∏≤">‡πÄ‚óå‡∏≤</option>
            <option value="‡πÄ‚óå‡∏≤‡∏∞">‡πÄ‚óå‡∏≤‡∏∞</option>
            <option value="‚óå‡∏≠">‚óå‡∏≠</option>
          </select>
          <button class="btn primary" onclick="makeSyllable()">‡∏ú‡∏™‡∏°</button>
          <button class="btn" onclick="speakWord()">üîä ‡∏≠‡πà‡∏≤‡∏ô</button>
        </div>
        <div id="syllableArea" class="mt12 big"></div>
        <div class="mt8">‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô:</div>
        <div id="syllableBreak" class="mt8"></div>
      </section>

      <!-- C. ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô -->
      <section class="card">
        <h2>‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡πÅ‡∏°‡πà ‡∏Å ‡∏Å‡∏≤) <span class="badge">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î üîä</span></h2>
        <div id="basicWords" class="wrap"></div>
        <div class="mt12">
          <button class="btn primary" onclick="speakSelected()">üîä ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>
          <button class="btn" onclick="shuffleWords()">‡∏™‡∏•‡∏±‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö</button>
        </div>
      </section>

      <!-- D. ‡∏≠‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå -->
      <section class="card">
        <h2>‡∏≠‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏™‡∏±‡πâ‡∏ô ‡πÜ <span class="badge">‡∏°‡∏µ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏ó‡∏µ‡∏•‡∏∞‡∏Ñ‡∏≥</span></h2>
        <div class="row">
          <button class="btn primary" onclick="playSentence()">‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á</button>
          <button class="btn" onclick="stopSpeech()">‚èπ ‡∏´‡∏¢‡∏∏‡∏î</button>
        </div>
        <div id="sentenceArea" class="mt12 big"></div>
        <div class="bar mt12"><i id="progress"></i></div>
      </section>

      <!-- E. ‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏£‡∏π (‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏π‡πâ‡∏à‡∏≥‡πÄ‡∏™‡∏µ‡∏¢‡∏á) -->
      <section class="card">
        <h2>‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏£‡∏π (‡∏ó‡∏î‡∏•‡∏≠‡∏á) <span class="badge">‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Chrome</span></h2>
        <div class="row">
          <button class="btn primary" onclick="startRec()">üé§ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á</button>
          <button class="btn warn" onclick="stopRec()">‡∏´‡∏¢‡∏∏‡∏î‡∏ü‡∏±‡∏á</button>
          <div id="recStatus" class="pill">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏û‡∏£‡πâ‡∏≠‡∏°</div>
        </div>
        <div class="mt12">‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏û‡∏π‡∏î: <span id="targetSay" class="word">‡∏Å‡∏≤</span>
          <button class="btn" onclick="newTarget()">‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏≥</button>
          <button class="btn" onclick="tts(document.getElementById('targetSay').textContent)">üîä ‡∏™‡∏≤‡∏ò‡∏¥‡∏ï</button>
        </div>
        <div id="heard" class="result mt12 mono">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô‡∏Ñ‡∏≥‡∏û‡∏π‡∏î</div>
      </section>
    </div>
  </main>
     <footer>
        ‡∏™‡∏∑‡πà‡∏≠‡∏ù‡∏∂‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ¬∑ ‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î‡πÉ‡∏ô‡∏ö‡∏£‡∏≤‡∏ß‡πÄ‡∏ã‡∏≠‡∏£‡πå (SpeechSynthesis) ¬∑ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Chrome/iOS ‡∏ö‡∏≤‡∏á‡∏£‡∏∏‡πà‡∏ô
        <p>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á : ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ú‡∏•‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô A &copy; 2025</p>
    </footer>

<script>
/* ---------- A. ‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞‡πÑ‡∏ó‡∏¢‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á ---------- */
const consonantSets = [
  {name:"‡∏Å-‡∏á", list:["‡∏Å ‡πÑ‡∏Å‡πà","‡∏Ç ‡πÑ‡∏Ç‡πà","‡∏É ‡∏Ç‡∏ß‡∏î","‡∏Ñ ‡∏Ñ‡∏ß‡∏≤‡∏¢","‡∏Ö ‡∏Ñ‡∏ô","‡∏Ü ‡∏£‡∏∞‡∏Ü‡∏±‡∏á","‡∏á ‡∏á‡∏π"]},
  {name:"‡∏à-‡∏î", list:["‡∏à ‡∏à‡∏≤‡∏ô","‡∏â ‡∏â‡∏¥‡πà‡∏á","‡∏ä ‡∏ä‡πâ‡∏≤‡∏á","‡∏ã ‡πÇ‡∏ã‡πà","‡∏å ‡πÄ‡∏å‡∏≠","‡∏ç ‡∏´‡∏ç‡∏¥‡∏á","‡∏é ‡∏ä‡∏é‡∏≤","‡∏è ‡∏õ‡∏è‡∏±‡∏Å","‡∏ê ‡∏ê‡∏≤‡∏ô","‡∏ë ‡∏°‡∏ì‡πÇ‡∏ë","‡∏í ‡∏ú‡∏π‡πâ‡πÄ‡∏í‡πà‡∏≤","‡∏ì ‡πÄ‡∏ì‡∏£","‡∏î ‡πÄ‡∏î‡πá‡∏Å"]},
  {name:"‡∏ï-‡∏ñ", list:["‡∏ï ‡πÄ‡∏ï‡πà‡∏≤","‡∏ñ ‡∏ñ‡∏∏‡∏á","‡∏ó ‡∏ó‡∏´‡∏≤‡∏£","‡∏ò ‡∏ò‡∏á"]},
  {name:"‡∏ô-‡∏ú", list:["‡∏ô ‡∏´‡∏ô‡∏π","‡∏ö ‡πÉ‡∏ö‡πÑ‡∏°‡πâ","‡∏õ ‡∏õ‡∏•‡∏≤","‡∏ú ‡∏ú‡∏∂‡πâ‡∏á"]},
  {name:"‡∏ù-‡∏®", list:["‡∏ù ‡∏ù‡∏≤","‡∏û ‡∏û‡∏≤‡∏ô","‡∏ü ‡∏ü‡∏±‡∏ô","‡∏† ‡∏™‡∏≥‡πÄ‡∏†‡∏≤","‡∏° ‡∏°‡πâ‡∏≤","‡∏¢ ‡∏¢‡∏±‡∏Å‡∏©‡πå","‡∏£ ‡πÄ‡∏£‡∏∑‡∏≠","‡∏• ‡∏•‡∏¥‡∏á","‡∏ß ‡πÅ‡∏´‡∏ß‡∏ô","‡∏® ‡∏®‡∏≤‡∏•‡∏≤"]},
  {name:"‡∏©-‡∏Æ", list:["‡∏© ‡∏§‡πÖ‡∏©‡∏µ","‡∏™ ‡πÄ‡∏™‡∏∑‡∏≠","‡∏´ ‡∏´‡∏µ‡∏ö","‡∏¨ ‡∏à‡∏∏‡∏¨‡∏≤","‡∏≠ ‡∏≠‡πà‡∏≤‡∏á","‡∏Æ ‡∏ô‡∏Å‡∏Æ‡∏π‡∏Å"]},
];
let setIndex = 0;
function renderConsonants(){
  const grid = document.getElementById('consonantGrid');
  grid.innerHTML = '';
  document.getElementById('setName').textContent = consonantSets[setIndex].name;
  consonantSets[setIndex].list.forEach(item=>{
    const [ch, word] = item.split(' ');
    const el = document.createElement('div');
    el.className = 'tile';
    el.innerHTML = `<div class="ch">${ch}</div><small>${item}</small><div class="mt8"><button class="btn primary" onclick="tts('${item}')">üîä ‡∏≠‡πà‡∏≤‡∏ô</button></div>`;
    grid.appendChild(el);
  });
}
function prevSet(){ setIndex = (setIndex - 1 + consonantSets.length) % consonantSets.length; renderConsonants(); }
function nextSet(){ setIndex = (setIndex + 1) % consonantSets.length; renderConsonants(); }
function speakSet(){
  const items = consonantSets[setIndex].list;
  speakQueue(items.map(x=>x));
}

/* ---------- B. ‡∏ú‡∏™‡∏°‡∏™‡∏£‡∏∞ ---------- */
function makeSyllable(){
  const c = document.getElementById('cons').value;
  const v = document.getElementById('vowel').value;
  const syl = v.replace('‚óå', c);
  const area = document.getElementById('syllableArea');
  area.textContent = syl;
  // ‡πÅ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÜ
  document.getElementById('syllableBreak').innerHTML =
    `<span class="syl">${v.includes('‚óå')?c:''}</span> <span class="syl">${v.replace('‚óå','‚óå')}</span>`;
}
function speakWord(){
  const w = document.getElementById('syllableArea').textContent || '';
  if(!w) return;
  tts(w);
}

/* ---------- C. ‡∏Ñ‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ---------- */
const words = ["‡∏Å‡∏≤","‡πÇ‡∏Å","‡πÄ‡∏Å","‡πÄ‡∏Å‡∏≤","‡πÅ‡∏Å","‡πÑ‡∏Å‡πà","‡πÑ‡∏Å","‡∏Å‡∏≠","‡∏Å‡∏≤‡πÅ‡∏ü","‡∏õ‡∏•‡∏≤","‡∏õ‡∏π","‡∏õ‡∏≤","‡∏°‡∏≤","‡∏°‡∏∑‡∏≠","‡πÑ‡∏°‡πâ","‡∏°‡∏µ","‡πÅ‡∏°‡∏ß","‡πÇ‡∏ï","‡πÇ‡∏ï‡πä‡∏∞","‡πÄ‡∏ï‡πà‡∏≤","‡∏ô‡∏Å","‡∏°‡∏î","‡∏£‡∏ñ","‡∏•‡∏¥‡∏á","‡∏•‡∏°","‡∏£‡∏≠"];
let selected = new Set();
function renderWords(){
  const area = document.getElementById('basicWords');
  area.innerHTML='';
  words.forEach(w=>{
    const span = document.createElement('span');
    span.className = 'word';
    span.textContent = w;
    span.onclick = ()=>{
      if(selected.has(w)){ selected.delete(w); span.style.background=''; }
      else { selected.add(w); span.style.background='#bbf7d0'; }
    };
    area.appendChild(span);
  });
}
function speakSelected(){
  if(selected.size===0){ speakQueue(["‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å"]); return; }
  speakQueue(Array.from(selected));
}
function shuffleWords(){
  for(let i=words.length-1;i>0;i--){
    const j = Math.floor(Math.random()* (i+1));
    [words[i],words[j]]=[words[j],words[i]];
  }
  renderWords();
}

/* ---------- D. ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏™‡∏±‡πâ‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå ---------- */
const sentences = [
  "‡πÅ‡∏°‡πà‡πÑ‡∏õ‡∏ï‡∏•‡∏≤‡∏î",
  "‡∏û‡πà‡∏≠‡∏°‡∏µ‡∏õ‡∏•‡∏≤",
  "‡∏°‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡πÇ‡∏ï‡πä‡∏∞",
  "‡∏•‡∏¥‡∏á‡∏Å‡∏¥‡∏ô‡∏Å‡∏•‡πâ‡∏ß‡∏¢",
  "‡∏ô‡∏Å‡∏ö‡∏¥‡∏ô‡∏ö‡∏ô‡∏ü‡πâ‡∏≤"
];
let sIndex = 0, cancelHighlight=false;
function playSentence(){
  cancelHighlight=false;
  const text = sentences[sIndex];
  showSentence(text);
  // ‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏Ñ‡∏≥
  const parts = text.split(' ');
  const bar = document.getElementById('progress');
  let i=0;
  function next(){
    if(cancelHighlight || i>=parts.length){ bar.style.width='0'; return; }
    highlightWord(i);
    tts(parts[i], ()=>{
      bar.style.width = ((i+1)/parts.length*100)+'%';
      i++; next();
    });
  }
  next();
  sIndex = (sIndex+1)%sentences.length;
}
function showSentence(text){
  const area = document.getElementById('sentenceArea');
  area.innerHTML = '';
  text.split(' ').forEach((w,idx)=>{
    const span = document.createElement('span');
    span.textContent = w;
    span.className = 'syl';
    span.id = 'w'+idx;
    area.appendChild(span);
  });
}
function highlightWord(i){
  const area = document.getElementById('sentenceArea');
  Array.from(area.children).forEach(el=>el.style.background='#fff');
  const el = document.getElementById('w'+i);
  if(el){ el.style.background='#fde68a'; }
}
function stopSpeech(){ cancelHighlight=true; speechSynthesis.cancel(); document.getElementById('progress').style.width='0'; }

/* ---------- E. ‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏£‡∏π (Speech Recognition ‚Äì ‡∏ó‡∏î‡∏•‡∏≠‡∏á) ---------- */
let rec, recActive=false;
function startRec(){
  const Ctor = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(!Ctor){ document.getElementById('recStatus').textContent = '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á'; return; }
  rec = new Ctor();
  rec.lang = 'th-TH'; rec.continuous = false; rec.interimResults = false;
  rec.onstart = ()=>{ recActive=true; setRecStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ü‡∏±‡∏á...'); };
  rec.onerror = (e)=>{ setRecStatus('‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î'); };
  rec.onend = ()=>{ recActive=false; setRecStatus('‡∏´‡∏¢‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß'); };
  rec.onresult = (e)=>{
    const txt = e.results[0][0].transcript.trim();
    document.getElementById('heard').textContent = '‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô‡∏ß‡πà‡∏≤: ' + txt;
    const target = document.getElementById('targetSay').textContent.trim();
    if(normalizeThai(txt) === normalizeThai(target)){
      document.getElementById('heard').textContent += ' ‚úÖ ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!';
    }else{
      document.getElementById('heard').textContent += ' ‚ùå ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà';
    }
  };
  rec.start();
}
function stopRec(){ if(recActive){ rec.stop(); } }
function setRecStatus(t){ document.getElementById('recStatus').textContent = '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ' + t; }
function normalizeThai(s){ return s.replace(/\s+/g,'').replace(/[‡∏±‡∏¥‡∏µ‡∏∂‡∏∏‡∏π‡πà‡πâ‡πä‡πã‡πå‡∏∫]/g,''); }
function newTarget(){
  const w = words[Math.floor(Math.random()*words.length)];
  document.getElementById('targetSay').textContent = w;
}

/* ---------- Speech helpers ---------- */
function tts(text, onend){
  const u = new SpeechSynthesisUtterance(text);
  u.lang = 'th-TH';
  u.rate = 0.95; u.pitch = 1.0;
  if(onend) u.onend = onend;
  speechSynthesis.cancel(); // reset queue
  speechSynthesis.speak(u);
}
function speakQueue(arr){
  if(!arr || arr.length===0) return;
  let i=0;
  function speakNext(){
    const u = new SpeechSynthesisUtterance(arr[i]);
    u.lang='th-TH'; u.rate=0.95;
    u.onend=()=>{ i++; if(i<arr.length) speakNext(); };
    speechSynthesis.speak(u);
  }
  speechSynthesis.cancel();
  speakNext();
}

/* init */
renderConsonants();
renderWords();
showSentence(sentences[0]);
</script>

        

</body>
</html>
